.\"
.\"  Copyright (C) 2004 Red Hat, Inc.  All rights reserved.

.\" groff -t -e -mandoc -Tlatin1 cman.5 | less

.tl 'cman(5)' 'cman(5)'

\fBNAME\fP
.in +7
cman - cluster.conf cman configuration section
.sp
.in -7


\fBDESCRIPTION\fP
.in +7
Cman configuration values are placed in the <cman> </cman> section of
\fBcluster.conf\fP.  Per-node configuration related to cman is placed
in the standard <clusternode> </clusternode> sections.  All cman
configuration settings are optional; usually none are used.
.in -7


\fIUDP port\fR
.in +7
By default, cman will use UDP port 6809 for internode communication.  This can
be changed by setting a port number as follows:

  <cman port="6809">
  </cman>
.in -7


\fIExpected votes\fR
.in +7
The expected votes value is used by cman to determine quorum.  The cluster is
quorate if the sum of votes of existing members is over half of the expected
votes value.  By default, cman_tool sets the expected votes value to be the sum
of votes of all nodes listed in cluster.conf.  This can be overriden by setting
an explicit expected_votes value as follows:

  <cman expected_votes="3">
  </cman>

If the cluster becomes partitioned, improper use of this option can result
in more than one partition gaining quorum.  In that event, nodes in each
partition will enable cluster services.
.in -7


\fITwo node clusters\fR
.in +7
Ordinarily, the loss of quorum after one out of two nodes fails will prevent
the remaining node from continuing (if both nodes have one vote.)  Special
configuration options can be set to allow the one remaining node to continue
operating if the other fails.  To do this only two nodes, each with one vote,
can be defined in cluster.conf.  The two_node and expected_votes values must
then be set to 1 in the cman section as follows.

  <cman two_node="1" expected_votes="1">
  </cman>
.in -7


\fINode votes\fR
.in +7
By default, a node is given one vote toward the calculation of quorum.
This can be changed by giving a node a specific number of votes as
follows:

  <clusternode name="nd1" votes="2">
  </clusternode>
.in -7


\fINode ID\fR
.in +7

By default, a node is assigned a nodeid by the cluster manager (cman) when
it joins the cluster.  This can be overriden by specifying a nodeid here.
Using this option will ensure that a given node always has the same ID.
A node's application to join the cluster may be rejected if you try to set
the nodeid to one that is already used.

  <clusternode name="nd1" nodeid="1">
  </clusternode>
.in -7


\fIMultihome network configuration\fR
.in +7
Cman can be configured to use multiple network interfaces.  If one fails it
should be able to continue running with the one remaining.  A node's name in
cluster.conf is always associated with the IP address on one network interface;
"nd1" in the following:

  <clusternode name="nd1">
  </clusternode>

To use a second network interface, the node must have a second hostname
associated with the IP address on that interface; "nd1-e1" in the following.
The second hostname is specfied in an "altname" section for each node.

  <clusternode name="nd1">
      <altname name="nd1-e1"/>
  </clusternode>
.in -7


\fIMulticast network configuration\fR
.in +7
Cman can be configured to use multicast instead of broadcast (broadcast is used
by default if no multicast parameters are given.)  To configure multicast when
one network interface is used add one line under the <cman> section and another
under the <clusternode> section:

  <cman>
      <multicast addr="224.0.0.1"/>
  </cman>

  <clusternode name="nd1">
      <multicast addr="224.0.0.1" interface="eth0"/>
  </clusternode>

The multicast addresses must match and the address must be usable on the
interface name given for the node.

When two interfaces are used, multicast is configured as follows:

  <cman>
      <multicast addr="224.0.0.1"/>
      <multicast addr="224.0.0.9"/>
  </cman>

  <clusternode name="nd1">
      <altname name="nd1-e1"/>
      <multicast addr="224.0.0.1" interface="eth0"/>
      <multicast addr="224.0.0.9" interface="eth1"/>
  </clusternode>
.in -7


.sp
.in -7
\fBSEE ALSO\fP
.in +7
cluster.conf(5), ccs(7), cman_tool(8)

